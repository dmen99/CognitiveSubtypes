from dataset import Dataset

data = Dataset()

# identify diagnoses
data.create_binary_variables("diagnoses", {"dx_Dementia": r"F01|F010|F011|F012|F013|F018|F019|F02|F020|F021|F022|F023|F024|F028|F03|G20|G21|G210|G211|G212|G213|G214|G218|G219|G22|G23|G32|G230|G231|G232|G233|G238|G239"})
data.create_binary_variables("diagnoses", {"dx_SSD": r"F2\d"})
data.create_binary_variables("diagnoses", {"dx_MoodDisorder": r"F30|F300|F301|F302|F308 |F309|F31|F310|F311|F312|F313|F314|F315|F316|F317|F318|F319|F32|F320|F321|F322|F323|F328|F329|F33|F330|F331|F332|F333|F334|F338|F339|F34|F340|F341|F348|F349"})
data.create_binary_variables("diagnoses", {"dx_AlcDep": r"F10|F100|F101|F102|F103|F104|F105|F106|F107|F108|F109"})
data.create_binary_variables("diagnoses", {"dx_SleepDisorder": r"F51|F510|F511|F512|F513|F514|F515|F518|F519|G47|G470|G471|G472|G473|G474|G478|G479"})
data.create_binary_variables("diagnoses", {"dx_AutoImmune": r"D80|D800|D801|D802|D803|D804|D805|D806|D807|D808|D809|D81|D810|D811|D812|D813|D814|D815|D816|D817|D818|D819|D82|D820|D821|D822|D823|D824|D828|D829|D83|D830|D831|D832|D838|D839|D84|D840|D841|D848|D849|D86|D860|D861|D862|D863|D868|D869|D89|D890|D891|D892|D893|D898|D899"})
data.create_binary_variables("diagnoses", {"dx_DiabetesMellitus": r"E10|E11|E12|E13|E14|O24"}) # E10-E14
data.create_binary_variables("diagnoses", {"dx_Infx": r"B95|B950|B951|B952|B953|B954|B955|B956|B957|B958|B96|B960|B961|B962|B963|B964|B965|B966|B967|B968|B97|B970|B971|B972|B973|B974|B975|B976|B977|B978|B98|B980|B981|B99|J16|J160|J161|J162|J163|J164|J165|J166|J167|J168|P37|P370|P371|P372|P373|P374|P375|P376|P377|P378|P379|R65|R650|R651|R652|R653|R654|R655|R656|R657|R658|R659" })
data.create_binary_variables("diagnoses", {"dx_Arthritis": r"M00\d|M01\d|M02\d|M03\d|M05\d|M06\d|M07\d|M08\d|M09\d|M10\d|M11\d|M12\d|M13\d|M14\d|M15\d|M16\d|M17\d|M18\d|M19\d"})
data.create_binary_variables("diagnoses", {"dx_CVD": r"I516|G46\d"})
data.create_binary_variables("diagnoses", {"dx_coma": "R402"})
data.create_binary_variables("diagnoses", {"dx_amnesia": r"R41\d"})
data.create_binary_variables("diagnoses", {"dx_demyelinating": r"G35|G36|G360|G361|G368|G369|G37|G370|G371|G372|G373|G374|G375|G378|G379"})
data.create_binary_variables("diagnoses", {"dx_Epilepsy": r"G40|G400|G401|G402|G403|G404|G405|G406|G407|G408|G409|G41|G410|G411|G412|G418|G419"})
data.clean("diagnoses")

# identify medications
data.create_binary_variables("medication0", {"med_SSRI_t0": "(1140867878|1140867888|1140879540|1140879544|1140921600|1141180212)"})
data.create_binary_variables("medication0", {"med_Antipsychotic_t0": "(1140867168|1140867208|1140867218|1140867406|1140867420|1140867444|1140867940|1140867942|1140867944|1140867948|1140868120|1140879658|1140879750|1140882098|1140928916|1141152848|1141195974)"})
data.create_binary_variables("medication0", {"med_Aspirin_t0": "(1140861806|1140864860|1140868226|1140868282|1140872040|1140882108|1140882190|1140882268|1140882392|1141163138|1141164044|1141167844)"})
data.create_binary_variables("medication0", {"med_Statin_t0": "(1140861958|1140888594|1140888648|1141146234|1141192410)"})
data.create_binary_variables("medication0", {"med_Antihypertensive_t0": "(1140860308|1140860332|1140860404|1140860418|1140860422|1140860426|1140860562|1140860696|1140860738|1140860764|1140860790|1140861088|1140864950|1140864952|1140866162|1140866324|1140866330|1140866332|1140866388|1140866738|1140879802|1140879806|1140879818|1140879842|1140888510|1140888552|1140909708|1140926778|1141146124|1141146126|1141146128|1141151016|1141153328|1141172682|1141180772|1141180778|1141187788|1141194810|1141195254|1141195258|1141201038)"})
data.create_binary_variables("medication0", {"med_immunoSuppress_t0": "(1140911642|1140925978|1141166294|1141173926)"})
data.clean("medication0")

data.create_binary_variables("medication2", {"med_SSRI_t2": "(1140867878|1140867888|1140879540|1140879544|1140921600|1141180212)"})
data.create_binary_variables("medication2", {"med_Antipsychotic_t2": "(1140867168|1140867208|1140867218|1140867406|1140867420|1140867444|1140867940|1140867942|1140867944|1140867948|1140868120|1140879658|1140879750|1140882098|1140928916|1141152848|1141195974)"})
data.create_binary_variables("medication2", {"med_Aspirin_t2": "(1140861806|1140864860|1140868226|1140868282|1140872040|1140882108|1140882190|1140882268|1140882392|1141163138|1141164044|1141167844)"})
data.create_binary_variables("medication2", {"med_Statin_t2": "(1140861958|1140888594|1140888648|1141146234|1141192410)"})
data.create_binary_variables("medication2", {"med_Antihypertensive_t2": "(1140860308|1140860332|1140860404|1140860418|1140860422|1140860426|1140860562|1140860696|1140860738|1140860764|1140860790|1140861088|1140864950|1140864952|1140866162|1140866324|1140866330|1140866332|1140866388|1140866738|1140879802|1140879806|1140879818|1140879842|1140888510|1140888552|1140909708|1140926778|1141146124|1141146126|1141146128|1141151016|1141153328|1141172682|1141180772|1141180778|1141187788|1141194810|1141195254|1141195258|1141201038)"})
data.create_binary_variables("medication2", {"med_immunoSuppress_t2": "(1140911642|1140925978|1141166294|1141173926)"})
data.clean("medication2")

data.recode_vars()
data.write_csv()